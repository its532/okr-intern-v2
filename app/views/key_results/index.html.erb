<div>
  <% @key_results.each do |key_result| %>
  <div class="flex">
  <% if key_result.okr_type == 'SectionOkr' %>
    <%= link_to '新規登録', new_key_result_comment_path(okr_id: params[:okr_id], key_result_id: key_result.id, okr_type: params[:okr_type]) %>
  <hr>
  <% elsif key_result.okr_type == 'PersonalOkr' && (current_user.admin? || current_user?(key_result.okr.user)) %>
    <%= link_to '新規登録', new_key_result_comment_path(okr_id: params[:okr_id], key_result_id: key_result.id, okr_type: params[:okr_type]) %>
  <hr>
  <% end %>
  </div>

  <h4><%= key_result.title %></h4>

  <ul>
    <% key_result.key_result_comments.each do |key_result_comment| %>
      <li><%= key_result_comment.month %></li>
      <li><span>コメント</span> : <%= key_result_comment.comment %></li>
      <li><span>KR達成の為の施作</span> : <%= key_result_comment.measure %></li>
      <% if key_result.okr_type == 'SectionOkr' %>
        <%= link_to '編集', edit_key_result_comment_path(id: key_result_comment.id, okr_id: params[:okr_id], key_result_id: key_result.id, okr_type: params[:okr_type]) %>
        <%= link_to '削除', key_result_comment_path(id: key_result_comment.id), method: :delete, data: { confirm: '削除してよろしいですか？' } %>
      <hr>
      <% elsif key_result.okr_type == 'PersonalOkr' && (current_user.admin? || current_user?(key_result.okr.user)) %>
        <%= link_to '編集', edit_key_result_comment_path(id: key_result_comment.id, okr_id: params[:okr_id], key_result_id: key_result.id, okr_type: params[:okr_type]) %>
        <%= link_to '削除', key_result_comment_path(id: key_result_comment.id), method: :delete, data: { confirm: '削除してよろしいですか？' } %>
      <hr>
      <% end %>
    <% end %>
  </ul>
  <% end %>
</div>
